!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet"],n):n(((t=t||self).L=t.L||{},t.L.geodesic={}),t.L)}(this,(function(t,n){"use strict";n=n&&n.hasOwnProperty("default")?n.default:n;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var a=function(t,n){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)n.hasOwnProperty(a)&&(t[a]=n[a])})(t,n)};function i(t,n){function i(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}var o=function(){return(o=Object.assign||function(t){for(var n,a=1,i=arguments.length;a<i;a++)for(var o in n=arguments[a])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)};function e(){for(var t=0,n=0,a=arguments.length;n<a;n++)t+=arguments[n].length;var i=Array(t),o=0;for(n=0;n<a;n++)for(var e=arguments[n],s=0,r=e.length;s<r;s++,o++)i[o]=e[s];return i}var s=function(){function t(t){this.options={},this.ellipsoid={a:6378137,b:6356752.3142,f:1/298.257223563},this.options=o(o({},this.options),t)}return t.prototype.toRadians=function(t){return t*Math.PI/180},t.prototype.toDegrees=function(t){return 180*t/Math.PI},t.prototype.wrap360=function(t){return 0<=t&&t<360?t:(t%360+360)%360},t.prototype.direct=function(t,n,a,i){void 0===i&&(i=100);var o=this.toRadians(t.lat),e=this.toRadians(t.lng),s=this.toRadians(n),r=a,h=1e3*Number.EPSILON,l=this.ellipsoid,c=l.a,p=l.b,u=l.f,M=Math.sin(s),f=Math.cos(s),d=(1-u)*Math.tan(o),y=1/Math.sqrt(1+d*d),g=d*y,v=Math.atan2(d,f),b=y*M,w=1-b*b,R=w*(c*c-p*p)/(p*p),m=1+R/16384*(4096+R*(R*(320-175*R)-768)),L=R/1024*(256+R*(R*(74-47*R)-128)),P=r/(p*m),O=null,D=null,E=null,N=null,_=0;do{E=Math.cos(2*v+P),N=P,P=r/(p*m)+L*(O=Math.sin(P))*(E+L/4*((D=Math.cos(P))*(2*E*E-1)-L/6*E*(4*O*O-3)*(4*E*E-3)))}while(Math.abs(P-N)>h&&++_<i);if(_>=i)throw new EvalError("Vincenty formula failed to converge after "+i+" iterations");var x=g*O-y*D*f,q=Math.atan2(g*D+y*O*f,(1-u)*Math.sqrt(b*b+x*x)),I=u/16*w*(4+u*(4-3*w)),j=e+(Math.atan2(O*M,y*D-g*O*f)-(1-I)*u*b*(P+I*O*(E+I*D*(2*E*E-1)))),G=Math.atan2(b,-x);return{lat:this.toDegrees(q),lng:this.wrap360(this.toDegrees(j)),bearing:this.wrap360(this.toDegrees(G))}},t.prototype.inverse=function(t,n,a){void 0===a&&(a=1e3);var i=t,o=n,e=this.toRadians(i.lat),s=this.toRadians(i.lng),r=this.toRadians(o.lat),h=this.toRadians(o.lng),l=Math.PI,c=Number.EPSILON,p=this.ellipsoid,u=p.a,M=p.b,f=p.f,d=h-s,y=(1-f)*Math.tan(e),g=1/Math.sqrt(1+y*y),v=y*g,b=(1-f)*Math.tan(r),w=1/Math.sqrt(1+b*b),R=b*w,m=Math.abs(d)>l/2||Math.abs(r-e)>l/2,L=d,P=null,O=null,D=m?l:0,E=0,N=m?-1:1,_=null,x=1,q=null,I=1,j=null,G=null,A=0;do{if(_=w*(P=Math.sin(L))*(w*P)+(g*R-v*w*(O=Math.cos(L)))*(g*R-v*w*O),Math.abs(_)<c)break;if(N=v*R+g*w*O,G=L,L=d+(1-(j=f/16*(I=1-(q=g*w*P/(E=Math.sqrt(_)))*q)*(4+f*(4-3*I))))*f*q*((D=Math.atan2(E,N))+j*E*((x=0!=I?N-2*v*R/I:0)+j*N*(2*x*x-1))),(m?Math.abs(L)-l:Math.abs(L))>l)throw new EvalError("λ > π")}while(Math.abs(L-G)>1e-12&&++A<a);if(A>=a)throw new EvalError("Vincenty formula failed to converge after "+a+" iterations");var C=I*(u*u-M*M)/(M*M),S=C/1024*(256+C*(C*(74-47*C)-128)),z=M*(1+C/16384*(4096+C*(C*(320-175*C)-768)))*(D-S*E*(x+S/4*(N*(2*x*x-1)-S/6*x*(4*E*E-3)*(4*x*x-3)))),B=Math.abs(_)<c?0:Math.atan2(w*P,g*R-v*w*O),T=Math.abs(_)<c?l:Math.atan2(g*P,-v*w+g*R*O);return{distance:z,initialBearing:Math.abs(z)<c?NaN:this.wrap360(this.toDegrees(B)),finalBearing:Math.abs(z)<c?NaN:this.wrap360(this.toDegrees(T))}},t.prototype.intersection=function(t,n,a,i){var o=this.toRadians(t.lat),e=this.toRadians(t.lng),s=this.toRadians(a.lat),r=this.toRadians(a.lng),h=this.toRadians(n),l=this.toRadians(i),c=s-o,p=r-e,u=Math.PI,M=Number.EPSILON,f=2*Math.asin(Math.sqrt(Math.sin(c/2)*Math.sin(c/2)+Math.cos(o)*Math.cos(s)*Math.sin(p/2)*Math.sin(p/2)));if(Math.abs(f)<M)return t;var d=(Math.sin(s)-Math.sin(o)*Math.cos(f))/(Math.sin(f)*Math.cos(o)),y=(Math.sin(o)-Math.sin(s)*Math.cos(f))/(Math.sin(f)*Math.cos(s)),g=Math.acos(Math.min(Math.max(d,-1),1)),v=Math.acos(Math.min(Math.max(y,-1),1)),b=h-(Math.sin(r-e)>0?g:2*u-g),w=(Math.sin(r-e)>0?2*u-v:v)-l;if(0==Math.sin(b)&&0==Math.sin(w))return null;if(Math.sin(b)*Math.sin(w)<0)return null;var R=-Math.cos(b)*Math.cos(w)+Math.sin(b)*Math.sin(w)*Math.cos(f),m=Math.atan2(Math.sin(f)*Math.sin(b)*Math.sin(w),Math.cos(w)+Math.cos(b)*R),L=Math.asin(Math.sin(o)*Math.cos(m)+Math.cos(o)*Math.sin(m)*Math.cos(h)),P=e+Math.atan2(Math.sin(h)*Math.sin(m)*Math.cos(o),Math.cos(m)-Math.sin(o)*Math.sin(L));return{lat:this.toDegrees(L),lng:this.toDegrees(P)}},t.prototype.midpoint=function(t,n){var a=this.toRadians(t.lat),i=this.toRadians(t.lng),o=this.toRadians(n.lat),e=this.toRadians(n.lng-t.lng),s=Math.cos(a),r=0,h=Math.sin(a),l={x:s+Math.cos(o)*Math.cos(e),y:r+Math.cos(o)*Math.sin(e),z:h+Math.sin(o)},c=Math.atan2(l.z,Math.sqrt(l.x*l.x+l.y*l.y)),p=i+Math.atan2(l.y,l.x);return{lat:this.toDegrees(c),lng:this.toDegrees(p)}},t}(),r=function(){function t(){this.geodesic=new s}return t.prototype.recursiveMidpoint=function(t,n,a){var i=[t,n],o=this.geodesic.midpoint(t,n);return a>0?(i.splice.apply(i,e([0,1],this.recursiveMidpoint(t,o,a-1))),i.splice.apply(i,e([i.length-2,2],this.recursiveMidpoint(o,n,a-1)))):i.splice(1,0,o),i},t.prototype.line=function(t,n){return this.recursiveMidpoint(t,n,2)},t.prototype.multilinestring=function(t){var n=this,a=[];return t.forEach((function(t){for(var i=[],o=1;o<t.length;o++)i.splice.apply(i,e([i.length-1,1],n.line(t[o-1],t[o])));a.push(i)})),a},t.prototype.linestring=function(t){return this.multilinestring([t])[0]},t}(),h=function(t){function a(a,i){var e=t.call(this)||this;e.options={},e.options=o(o({},e.options),i);new r;return e.polyline=n.polyline(a,e.options),e}return i(a,t),a.prototype.onAdd=function(t){return this.polyline.addTo(t),this},a.prototype.onRemove=function(){return this.polyline.remove(),this},a.prototype.setLatLngs=function(t){return this.polyline.setLatLngs(t),this},a.prototype.asPolyline=function(){return console.log("[ Geodesic ]: asPolyline()"),[[0,0]]},a}(n.Layer),l=function(t){function a(a,i){var e=t.call(this)||this;return e.options={},e.options=o(o({},e.options),i),e.polygon=n.polygon(a,e.options),e}return i(a,t),a.prototype.onAdd=function(t){return this.polygon.addTo(t),this},a.prototype.onRemove=function(){return this.polygon.remove(),this},a.prototype.setLatLngs=function(t){return this.polygon.setLatLngs(t),this},a.prototype.asPolyline=function(){return console.log("[ Geodesic ]: asPolyline()"),[[0,0]]},a}(n.Layer);n.Geodesic=h,n.geodesic=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new(h.bind.apply(h,e([void 0],t)))},n.GreatCircle=l,n.greatcircle=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new(l.bind.apply(l,e([void 0],t)))},t.GeodesicLine=h,t.GreatCircleClass=l,Object.defineProperty(t,"__esModule",{value:!0})}));
