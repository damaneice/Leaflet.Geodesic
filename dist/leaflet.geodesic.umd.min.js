!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet"],n):n(((t=t||self).L=t.L||{},t.L.geodesic={}),t.L)}(this,(function(t,n){"use strict";n=n&&n.hasOwnProperty("default")?n.default:n;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var a=function(t,n){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)n.hasOwnProperty(a)&&(t[a]=n[a])})(t,n)};function o(t,n){function o(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}var i=function(){return(i=Object.assign||function(t){for(var n,a=1,o=arguments.length;a<o;a++)for(var i in n=arguments[a])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)};function e(){for(var t=0,n=0,a=arguments.length;n<a;n++)t+=arguments[n].length;var o=Array(t),i=0;for(n=0;n<a;n++)for(var e=arguments[n],r=0,s=e.length;r<s;r++,i++)o[i]=e[r];return o}var r=function(){function t(t){this.options={},this.ellipsoid={a:6378137,b:6356752.3142,f:1/298.257223563},this.options=i(i({},this.options),t)}return t.prototype.toRadians=function(t){return t*Math.PI/180},t.prototype.toDegrees=function(t){return 180*t/Math.PI},t.prototype.wrap360=function(t){return 0<=t&&t<360?t:(t%360+360)%360},t.prototype.direct=function(t,n,a,o){void 0===o&&(o=100);var i=this.toRadians(t.lat),e=this.toRadians(t.lng),r=this.toRadians(n),s=a,h=1e3*Number.EPSILON,l=this.ellipsoid,u=l.a,c=l.b,p=l.f,f=Math.sin(r),M=Math.cos(r),g=(1-p)*Math.tan(i),d=1/Math.sqrt(1+g*g),y=g*d,v=Math.atan2(g,M),b=d*f,L=1-b*b,w=L*(u*u-c*c)/(c*c),m=1+w/16384*(4096+w*(w*(320-175*w)-768)),E=w/1024*(256+w*(w*(74-47*w)-128)),R=s/(c*m),x=null,P=null,O=null,j=null,D=0;do{O=Math.cos(2*v+R),j=R,R=s/(c*m)+E*(x=Math.sin(R))*(O+E/4*((P=Math.cos(R))*(2*O*O-1)-E/6*O*(4*x*x-3)*(4*O*O-3)))}while(Math.abs(R-j)>h&&++D<o);if(D>=o)throw new EvalError("Vincenty formula failed to converge after "+o+" iterations");var N=y*x-d*P*M,_=Math.atan2(y*P+d*x*M,(1-p)*Math.sqrt(b*b+N*N)),q=p/16*L*(4+p*(4-3*L)),k=e+(Math.atan2(x*f,d*P-y*x*M)-(1-q)*p*b*(R+q*x*(O+q*P*(2*O*O-1)))),I=Math.atan2(b,-N);return{lat:this.toDegrees(_),lng:this.wrap360(this.toDegrees(k)),bearing:this.wrap360(this.toDegrees(I))}},t.prototype.inverse=function(t,n,a){void 0===a&&(a=1e3);var o=t,i=n,e=this.toRadians(o.lat),r=this.toRadians(o.lng),s=this.toRadians(i.lat),h=this.toRadians(i.lng),l=Math.PI,u=Number.EPSILON,c=this.ellipsoid,p=c.a,f=c.b,M=c.f,g=h-r,d=(1-M)*Math.tan(e),y=1/Math.sqrt(1+d*d),v=d*y,b=(1-M)*Math.tan(s),L=1/Math.sqrt(1+b*b),w=b*L,m=Math.abs(g)>l/2||Math.abs(s-e)>l/2,E=g,R=null,x=null,P=m?l:0,O=0,j=m?-1:1,D=null,N=1,_=null,q=1,k=null,I=null,A=0;do{if(D=L*(R=Math.sin(E))*(L*R)+(y*w-v*L*(x=Math.cos(E)))*(y*w-v*L*x),Math.abs(D)<u)break;if(j=v*w+y*L*x,I=E,E=g+(1-(k=M/16*(q=1-(_=y*L*R/(O=Math.sqrt(D)))*_)*(4+M*(4-3*q))))*M*_*((P=Math.atan2(O,j))+k*O*((N=0!=q?j-2*v*w/q:0)+k*j*(2*N*N-1))),(m?Math.abs(E)-l:Math.abs(E))>l)throw new EvalError("λ > π")}while(Math.abs(E-I)>1e-12&&++A<a);if(A>=a)throw new EvalError("Vincenty formula failed to converge after "+a+" iterations");var G=q*(p*p-f*f)/(f*f),C=G/1024*(256+G*(G*(74-47*G)-128)),S=f*(1+G/16384*(4096+G*(G*(320-175*G)-768)))*(P-C*O*(N+C/4*(j*(2*N*N-1)-C/6*N*(4*O*O-3)*(4*N*N-3)))),U=Math.abs(D)<u?0:Math.atan2(L*R,y*w-v*L*x),z=Math.abs(D)<u?l:Math.atan2(y*R,-v*L+y*w*x);return{distance:S,initialBearing:Math.abs(S)<u?NaN:this.wrap360(this.toDegrees(U)),finalBearing:Math.abs(S)<u?NaN:this.wrap360(this.toDegrees(z))}},t.prototype.intersection=function(t,n,a,o){var i=this.toRadians(t.lat),e=this.toRadians(t.lng),r=this.toRadians(a.lat),s=this.toRadians(a.lng),h=this.toRadians(n),l=this.toRadians(o),u=r-i,c=s-e,p=Math.PI,f=Number.EPSILON,M=2*Math.asin(Math.sqrt(Math.sin(u/2)*Math.sin(u/2)+Math.cos(i)*Math.cos(r)*Math.sin(c/2)*Math.sin(c/2)));if(Math.abs(M)<f)return t;var g=(Math.sin(r)-Math.sin(i)*Math.cos(M))/(Math.sin(M)*Math.cos(i)),d=(Math.sin(i)-Math.sin(r)*Math.cos(M))/(Math.sin(M)*Math.cos(r)),y=Math.acos(Math.min(Math.max(g,-1),1)),v=Math.acos(Math.min(Math.max(d,-1),1)),b=h-(Math.sin(s-e)>0?y:2*p-y),L=(Math.sin(s-e)>0?2*p-v:v)-l;if(0==Math.sin(b)&&0==Math.sin(L))return null;if(Math.sin(b)*Math.sin(L)<0)return null;var w=-Math.cos(b)*Math.cos(L)+Math.sin(b)*Math.sin(L)*Math.cos(M),m=Math.atan2(Math.sin(M)*Math.sin(b)*Math.sin(L),Math.cos(L)+Math.cos(b)*w),E=Math.asin(Math.sin(i)*Math.cos(m)+Math.cos(i)*Math.sin(m)*Math.cos(h)),R=e+Math.atan2(Math.sin(h)*Math.sin(m)*Math.cos(i),Math.cos(m)-Math.sin(i)*Math.sin(E));return{lat:this.toDegrees(E),lng:this.toDegrees(R)}},t.prototype.midpoint=function(t,n){var a=this.toRadians(t.lat),o=this.toRadians(t.lng),i=this.toRadians(n.lat),e=this.toRadians(n.lng-t.lng),r=Math.cos(a),s=0,h=Math.sin(a),l={x:r+Math.cos(i)*Math.cos(e),y:s+Math.cos(i)*Math.sin(e),z:h+Math.sin(i)},u=Math.atan2(l.z,Math.sqrt(l.x*l.x+l.y*l.y)),c=o+Math.atan2(l.y,l.x);return{lat:this.toDegrees(u),lng:this.toDegrees(c)}},t}(),s=function(){function t(){this.geodesic=new r}return t.prototype.recursiveMidpoint=function(t,n,a){var o=[t,n],i=this.geodesic.midpoint(t,n);return a>0?(o.splice.apply(o,e([0,1],this.recursiveMidpoint(t,i,a-1))),o.splice.apply(o,e([o.length-2,2],this.recursiveMidpoint(i,n,a-1)))):o.splice(1,0,i),o},t.prototype.line=function(t,n){return this.recursiveMidpoint(t,n,3)},t.prototype.multilinestring=function(t){var n=this,a=[];return t.forEach((function(t){for(var o=[],i=1;i<t.length;i++)o.splice.apply(o,e([o.length-1,1],n.line(t[i-1],t[i])));a.push(o)})),a},t.prototype.linestring=function(t){return this.multilinestring([t])[0]},t}();function h(t){return"object"==typeof t&&null!==typeof t&&"lat"in t&&"lng"in t&&"number"==typeof t.lat&&"number"==typeof t.lng}function l(t){return t instanceof Array&&"number"==typeof t[0]&&"number"==typeof t[1]}function u(t){return t instanceof n.LatLng||(!!l(t)||!!h(t))}function c(t){if(t instanceof n.LatLng)return{lat:t.lat,lng:t.lng};if(l(t))return{lat:t[0],lng:t[1]};if(h(t))return t;throw new Error("L.LatLngExpression expected. Unknown object found.")}function p(t){for(var n=[],a=function(a){if(u(a)){var o=[];return t.forEach((function(t){o.push(c(t))})),n.push(o),"break"}if(!(a instanceof Array))throw new Error("L.LatLngExpression[] | L.LatLngExpression[][] expected. Unknown object found.");if(!u(a[0]))throw new Error("L.LatLngExpression[] | L.LatLngExpression[][] expected. Unknown object found.");var i=[];a.forEach((function(t){i.push(c(t))})),n.push(i)},o=0,i=t;o<i.length;o++){if("break"===a(i[o]))break}return n}var f=function(t){function a(a,o){var e=t.call(this)||this;return e.options={},e.geom=new s,e.options=i(i({},e.options),o),e.polyline=n.polyline(e.geom.multilinestring(p(a)),e.options),e}return o(a,t),a.prototype.onAdd=function(t){return this.polyline.addTo(t),this},a.prototype.onRemove=function(){return this.polyline.remove(),this},a.prototype.setLatLngs=function(t){return this.polyline.setLatLngs(this.geom.multilinestring(p(t))),this},a}(n.Layer),M=function(t){function a(a,o){var e=t.call(this)||this;return e.options={},e.options=i(i({},e.options),o),e.polygon=n.polygon(a,e.options),e}return o(a,t),a.prototype.onAdd=function(t){return this.polygon.addTo(t),this},a.prototype.onRemove=function(){return this.polygon.remove(),this},a.prototype.setLatLngs=function(t){return this.polygon.setLatLngs(t),this},a.prototype.asPolyline=function(){return console.log("[ Geodesic ]: asPolyline()"),[[0,0]]},a}(n.Layer);n.Geodesic=f,n.geodesic=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new(f.bind.apply(f,e([void 0],t)))},n.GreatCircle=M,n.greatcircle=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new(M.bind.apply(M,e([void 0],t)))},t.GeodesicLine=f,t.GreatCircleClass=M,Object.defineProperty(t,"__esModule",{value:!0})}));
