!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet"],n):n(((t=t||self).L=t.L||{},t.L.geodesic={}),t.L)}(this,(function(t,n){"use strict";n=n&&n.hasOwnProperty("default")?n.default:n;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var i=function(t,n){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(t,n)};function a(t,n){function a(){this.constructor=t}i(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}var e=function(){return(e=Object.assign||function(t){for(var n,i=1,a=arguments.length;i<a;i++)for(var e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)};function o(){for(var t=0,n=0,i=arguments.length;n<i;n++)t+=arguments[n].length;var a=Array(t),e=0;for(n=0;n<i;n++)for(var o=arguments[n],r=0,s=o.length;r<s;r++,e++)a[e]=o[r];return a}var r=function(){function t(t){this.options={},this.ellipsoid={a:6378137,b:6356752.3142,f:1/298.257223563},this.options=e(e({},this.options),t)}return t.prototype.toRadians=function(t){return t*Math.PI/180},t.prototype.toDegrees=function(t){return 180*t/Math.PI},t.prototype.wrap360=function(t){return 0<=t&&t<360?t:(t%360+360)%360},t.prototype.wrap180=function(t){return-180<=t&&t<180?t:((t+180)%360+360)%360-180},t.prototype.direct=function(t,n,i,a){void 0===a&&(a=100);var e=this.toRadians(t.lat),o=this.toRadians(t.lng),r=this.toRadians(n),s=i,h=1e3*Number.EPSILON,l=this.ellipsoid,u=l.a,p=l.b,c=l.f,f=Math.sin(r),M=Math.cos(r),g=(1-c)*Math.tan(e),d=1/Math.sqrt(1+g*g),y=g*d,v=Math.atan2(g,M),L=d*f,b=1-L*L,w=b*(u*u-p*p)/(p*p),m=1+w/16384*(4096+w*(w*(320-175*w)-768)),E=w/1024*(256+w*(w*(74-47*w)-128)),R=s/(p*m),x=null,P=null,O=null,D=null,j=0;do{O=Math.cos(2*v+R),D=R,R=s/(p*m)+E*(x=Math.sin(R))*(O+E/4*((P=Math.cos(R))*(2*O*O-1)-E/6*O*(4*x*x-3)*(4*O*O-3)))}while(Math.abs(R-D)>h&&++j<a);if(j>=a)throw new EvalError("Direct vincenty formula failed to converge after "+a+" iterations (start="+t.lat+"/"+t.lng+"; bearing="+n+"; distance="+i+")");var N=y*x-d*P*M,_=Math.atan2(y*P+d*x*M,(1-c)*Math.sqrt(L*L+N*N)),S=c/16*b*(4+c*(4-3*b)),q=o+(Math.atan2(x*f,d*P-y*x*M)-(1-S)*c*L*(R+S*x*(O+S*P*(2*O*O-1)))),I=Math.atan2(L,-N);return{lat:this.toDegrees(_),lng:this.wrap360(this.toDegrees(q)),bearing:this.wrap360(this.toDegrees(I))}},t.prototype.inverse=function(t,n,i){void 0===i&&(i=1e3);var a=t,e=n,o=this.toRadians(a.lat),r=this.toRadians(a.lng),s=this.toRadians(e.lat),h=this.toRadians(e.lng),l=Math.PI,u=Number.EPSILON,p=this.ellipsoid,c=p.a,f=p.b,M=p.f,g=h-r,d=(1-M)*Math.tan(o),y=1/Math.sqrt(1+d*d),v=d*y,L=(1-M)*Math.tan(s),b=1/Math.sqrt(1+L*L),w=L*b,m=Math.abs(g)>l/2||Math.abs(s-o)>l/2,E=g,R=null,x=null,P=m?l:0,O=0,D=m?-1:1,j=null,N=1,_=null,S=1,q=null,I=null,k=0;do{if(j=b*(R=Math.sin(E))*(b*R)+(y*w-v*b*(x=Math.cos(E)))*(y*w-v*b*x),Math.abs(j)<u)break;if(D=v*w+y*b*x,I=E,E=g+(1-(q=M/16*(S=1-(_=y*b*R/(O=Math.sqrt(j)))*_)*(4+M*(4-3*S))))*M*_*((P=Math.atan2(O,D))+q*O*((N=0!=S?D-2*v*w/S:0)+q*D*(2*N*N-1))),(m?Math.abs(E)-l:Math.abs(E))>l)throw new EvalError("λ > π")}while(Math.abs(E-I)>1e-12&&++k<i);if(k>=i)throw new EvalError("Inverse vincenty formula failed to converge after "+i+" iterations (start="+t.lat+"/"+t.lng+"; dest="+n.lat+"/"+n.lng+")");var A=S*(c*c-f*f)/(f*f),B=A/1024*(256+A*(A*(74-47*A)-128)),G=f*(1+A/16384*(4096+A*(A*(320-175*A)-768)))*(P-B*O*(N+B/4*(D*(2*N*N-1)-B/6*N*(4*O*O-3)*(4*N*N-3)))),C=Math.abs(j)<u?0:Math.atan2(b*R,y*w-v*b*x),U=Math.abs(j)<u?l:Math.atan2(y*R,-v*b+y*w*x);return{distance:G,initialBearing:Math.abs(G)<u?NaN:this.wrap360(this.toDegrees(C)),finalBearing:Math.abs(G)<u?NaN:this.wrap360(this.toDegrees(U))}},t.prototype.intersection=function(t,n,i,a){var e=this.toRadians(t.lat),o=this.toRadians(t.lng),r=this.toRadians(i.lat),s=this.toRadians(i.lng),h=this.toRadians(n),l=this.toRadians(a),u=r-e,p=s-o,c=Math.PI,f=Number.EPSILON,M=2*Math.asin(Math.sqrt(Math.sin(u/2)*Math.sin(u/2)+Math.cos(e)*Math.cos(r)*Math.sin(p/2)*Math.sin(p/2)));if(Math.abs(M)<f)return t;var g=(Math.sin(r)-Math.sin(e)*Math.cos(M))/(Math.sin(M)*Math.cos(e)),d=(Math.sin(e)-Math.sin(r)*Math.cos(M))/(Math.sin(M)*Math.cos(r)),y=Math.acos(Math.min(Math.max(g,-1),1)),v=Math.acos(Math.min(Math.max(d,-1),1)),L=h-(Math.sin(s-o)>0?y:2*c-y),b=(Math.sin(s-o)>0?2*c-v:v)-l;if(0==Math.sin(L)&&0==Math.sin(b))return null;if(Math.sin(L)*Math.sin(b)<0)return null;var w=-Math.cos(L)*Math.cos(b)+Math.sin(L)*Math.sin(b)*Math.cos(M),m=Math.atan2(Math.sin(M)*Math.sin(L)*Math.sin(b),Math.cos(b)+Math.cos(L)*w),E=Math.asin(Math.sin(e)*Math.cos(m)+Math.cos(e)*Math.sin(m)*Math.cos(h)),R=o+Math.atan2(Math.sin(h)*Math.sin(m)*Math.cos(e),Math.cos(m)-Math.sin(e)*Math.sin(E));return{lat:this.toDegrees(E),lng:this.toDegrees(R)}},t.prototype.midpoint=function(t,n){var i=this.toRadians(t.lat),a=this.toRadians(t.lng),e=this.toRadians(n.lat),o=this.toRadians(n.lng-t.lng),r=Math.cos(i),s=0,h=Math.sin(i),l={x:r+Math.cos(e)*Math.cos(o),y:s+Math.cos(e)*Math.sin(o),z:h+Math.sin(e)},u=Math.atan2(l.z,Math.sqrt(l.x*l.x+l.y*l.y)),p=a+Math.atan2(l.y,l.x);return{lat:this.wrap180(this.toDegrees(u)),lng:this.wrap180(this.toDegrees(p))}},t}(),s=function(){function t(){this.geodesic=new r}return t.prototype.recursiveMidpoint=function(t,n,i){var a=[t,n],e=this.geodesic.midpoint(t,n);return i>0?(a.splice.apply(a,o([0,1],this.recursiveMidpoint(t,e,i-1))),a.splice.apply(a,o([a.length-2,2],this.recursiveMidpoint(e,n,i-1)))):a.splice(1,0,e),a},t.prototype.line=function(t,n){return this.recursiveMidpoint(t,n,4)},t.prototype.multiLineString=function(t){var n=this,i=[];return t.forEach((function(t){for(var a=[],e=1;e<t.length;e++)a.splice.apply(a,o([a.length-1,1],n.line(t[e-1],t[e])));i.push(a)})),i},t.prototype.lineString=function(t){return this.multiLineString([t])[0]},t.prototype.splitLine=function(t,n){var i,a={lat:89,lng:-180},e=180,o={lat:89,lng:180},r=180,s=this.geodesic.inverse(t,n);if((i=s.initialBearing>180?this.geodesic.intersection(t,s.initialBearing,a,e):this.geodesic.intersection(t,s.initialBearing,o,r))&&this.geodesic.inverse(t,i).distance<s.distance)return i.lng<-179.9999?[[t,i],[{lat:i.lat,lng:i.lng+360},n]]:i.lng>179.9999?[[t,i],[{lat:i.lat,lng:i.lng-360},n]]:[[t,i],[i,n]];return[[t,n]]},t.prototype.splitMultiLineString=function(t){var n=this,i=[];return t.forEach((function(t){for(var a=[t[0]],e=1;e<t.length;e++){var o=n.splitLine(t[e-1],t[e]);1===o.length?a.push(t[e]):(a.push(o[0][1]),i.push(a),a=o[1])}i.push(a)})),i},t}();function h(t){return"object"==typeof t&&null!==typeof t&&"lat"in t&&"lng"in t&&"number"==typeof t.lat&&"number"==typeof t.lng}function l(t){return t instanceof Array&&"number"==typeof t[0]&&"number"==typeof t[1]}function u(t){return t instanceof n.LatLng||(!!l(t)||!!h(t))}function p(t){if(t instanceof n.LatLng)return{lat:t.lat,lng:t.lng};if(l(t))return{lat:t[0],lng:t[1]};if(h(t))return t;throw new Error("L.LatLngExpression expected. Unknown object found.")}var c=function(t){function i(i,a){var o=t.call(this)||this;return o.options={},o.geom=new s,o.options=e(e({},o.options),a),o.polyline=n.polyline([],o.options),o.update(i),o}return a(i,t),i.prototype.onAdd=function(t){return this.polyline.addTo(t),this},i.prototype.onRemove=function(){return this.polyline.remove(),this},i.prototype.update=function(t){var n=this.geom.multiLineString(function(t){for(var n=[],i=function(i){if(u(i)){var a=[];return t.forEach((function(t){a.push(p(t))})),n.push(a),"break"}if(!(i instanceof Array))throw new Error("L.LatLngExpression[] | L.LatLngExpression[][] expected. Unknown object found.");if(!u(i[0]))throw new Error("L.LatLngExpression[] | L.LatLngExpression[][] expected. Unknown object found.");var e=[];i.forEach((function(t){e.push(p(t))})),n.push(e)},a=0,e=t;a<e.length;a++){if("break"===i(e[a]))break}return n}(t));this.polyline.setLatLngs(this.geom.splitMultiLineString(n))},i.prototype.setLatLngs=function(t){return this.update(t),this},i.prototype.getLatLngs=function(){return this.polyline.getLatLngs()},i}(n.Layer),f=function(t){function i(i,a){var o=t.call(this)||this;return o.options={},o.options=e(e({},o.options),a),o.polygon=n.polygon(i,o.options),o}return a(i,t),i.prototype.onAdd=function(t){return this.polygon.addTo(t),this},i.prototype.onRemove=function(){return this.polygon.remove(),this},i.prototype.setLatLngs=function(t){return this.polygon.setLatLngs(t),this},i.prototype.asPolyline=function(){return console.log("[ Geodesic ]: asPolyline()"),[[0,0]]},i}(n.Layer);n.Geodesic=c,n.geodesic=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new(c.bind.apply(c,o([void 0],t)))},n.GreatCircle=f,n.greatcircle=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new(f.bind.apply(f,o([void 0],t)))},t.GeodesicLine=c,t.GreatCircleClass=f,Object.defineProperty(t,"__esModule",{value:!0})}));
